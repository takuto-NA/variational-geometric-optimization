---
title: "第0章 序文"
---

## 0.1 この書籍の立ち位置（理論と実装のあいだ）

本書は、多様体／関数空間上の汎関数を中心に据え、そこから導かれる

- 散逸（勾配流）
- Newton 型条件（停留条件；Newton は Algorithm（方程式ソルバ）としても Geometry（Hessian 計量）としても現れる。第5章 [5.3](./chap05-methods-map#5-3-newton-法の二面性algorithm-か-geometry-か) で整理）
- 保存（Hamilton 流）
- 制約（KKT / サドル点）

を同一の“変分構造”の言葉で整理し、分野横断で実装可能な形に再編成することを目的とします。  
言い換えると、本書が与えたいのは理論と実装の間にある“翻訳層”です。

（用語の補足）多様体は「局所的に $\mathbb R^n$ のように見える空間」、関数空間は「関数そのものを変数とみなす空間」を指す。初出用語は [Glossary](../glossary) を参照。

本書の立場は次です：

- 数学的には「厳密な公理化」よりも見通しを優先する
- ただし、各分野の標準的概念（変分、計量、Hamilton 構造、KKT）と矛盾する主張はしない
- 実装では「何を計算すればよいか」に落ちる形（一次・二次変分、線形化）を重視する
- 変数の空間 $\mathcal M$ は多様体（線形空間は特殊例）として扱い、Hilbert 空間／リーマン多様体の仮定は必要になった箇所で「選択（knob）」として導入する

### 最初の5分で掴む「最小の絵」（3行）

- 入力: `Functional 𝓕` と `Space 𝓜`
- 出力: `Stationary condition d𝓕=0` と（必要なら）`local shape H`
- 翻訳: `Geometry (G,K,J)` により `d𝓕 (covector)` を `update / dynamics (vector)` に変換する

## 0.2 本書でやること／やらないこと（スコープ宣言）

### 本書でやること

- 停留構造（一次・二次変分、線形化）を座標・離散化に依らない形で先に定義し、その後に座標表示へ降ろす
- 空間（有限次元／関数空間）・離散化（FEM/NN）・幾何（計量・反対称構造）の違いを、同一骨格の具体化として整理する
- 実装の観点では、必要な計算部品（一次・二次変分、線形作用素、制約の扱い）を「何を持てばよいか」に落とす

### 本書でやらないこと

- 関数解析・微分幾何の厳密な公理化や証明の網羅
- 個別分野の教科書的な導出の再掲（必要最小限の“翻訳”に絞る）
- 非滑らか最適化（subgradient / prox など）の体系的整理（境界例は [第7章 7.2.1](./chap07-cross-domain#7-2-1-境界例非滑らか最適化proxsubgradientはこの地図の外側) を参照）
- 特定ライブラリの手取り足取りチュートリアル
- 新理論・新アルゴリズムの提案

厳密化で問題になりうる点（境界項、正則性、関数空間の同一視など）は、本文中で仮定として分離します。

## 0.3 想定読者と前提

想定読者は実装まで含めて最適化を扱いたい実務者／研究者です。
具体的には次を既知として話を進めます：

- 勾配降下法、Newton 法の基本
- 勾配・Hessian（少なくともユークリッド空間での意味）
- 制約付き最適化の基本（KKT 条件の存在と形）

一方で、多様体・関数空間・計量といった概念は扱うが、
最初は厳密な微分幾何の公理系を前提にしない。
必要な範囲で「最適化で慣れている記号を空間一般へ拡張する」という順に橋をかける。

関数解析（Banach/Hilbert、双対、弱形式、Sobolev など）も前提にしない。
ただし FEM/PDE・制御・関数空間最適化を読むために必要な最小セットは、本文の `Remark` と [付録C](./appC-functional-analysis-minimum) でフォローする。

## 0.4 “optimization” という言葉について

本書でいう最適化（optimization）は、狭義の「極小化アルゴリズム」に限定しない。
ここでの主語は常に停留構造です：

$$
d\mathcal F(x^*) = 0
$$

（有限次元ユークリッド空間では $d\mathcal F\simeq\nabla\mathcal F$ と同一視できるため、$\nabla\mathcal F(x^*)=0$ とも書ける。）

勾配流・Newton 条件・Hamilton 流は、同じ停留点を中心に「収束」または「回転」という異なる力学的挙動を示す。

## 0.5 記法（最小）

- 対象空間を $\mathcal M$、汎関数を $\mathcal F:\mathcal M\to\mathbb R$ と書く。
- 本書の数式は KaTeX を想定し、インラインは `$...$`、ブロックは `$$...$$` を基本とする。

### 主要記号

| 記号 | 意味 | 備考 |
|------|------|------|
| $G$ | 計量（対称正定値） | Riesz 写像を誘導、$\flat_G: T\mathcal M \to T^*\mathcal M$ |
| $K$ | 散逸作用素（対称半正定値） | 典型例は $G^{-1}$、$T^*\mathcal M \to T\mathcal M$ |
| $J$ | 反対称構造（保存） | シンプレクティック構造など |
| $H$ | Hessian 作用素 | $H := \nabla^2\mathcal F$、二次変分の行列表現 |

（向きの最小メモ）

- $d\mathcal F \in T^*\mathcal M$（一次変分は共ベクトル）
- $G, H : T\mathcal M \to T^*\mathcal M$
- $K, J : T^*\mathcal M \to T\mathcal M$

「勾配」$\nabla\mathcal F$ は空間と計量に依存して定まる（Riesz 表現）。
本書ではまずユークリッド空間の直感を出発点にし、必要なところで関数空間・多様体へ拡張する。

（読み方の補足）本文では $\nabla\mathcal F$ を座標表示として使う箇所があるが、原理的には $d\mathcal F$（共ベクトル）を計量で同一視している、と読むと混乱しにくい。

> $G$ と $K$ の関係: 計量 $G$ は「共ベクトルをベクトルに変換する」Riesz 写像の逆 $G^{-1}$ を誘導する。散逸作用素 $K$ の最も単純な例が $K = G^{-1}$ であり、このとき勾配流は $\dot x = -K\,d\mathcal F = -G^{-1}d\mathcal F = -\operatorname{grad}_G\mathcal F$ となる。第3章では $K$ を一般化して扱う。

> Note（記号衝突）: FEM などで慣習的に使われる「剛性行列 $K$」と、本書の「散逸作用素 $K$（$T^*\to T$）」は向きが逆である。誤読しやすい点の短い注意は [第3章 3.1.1](./chap03-general-equation#記号衝突注意散逸作用素-k-と-fem-の剛性行列-k) を参照。

## 0.6 本書の読み方

- 理論（Part I）では、まず統一式と停留点を地図として確立する。
  以後の分野別応用は、その地図上で座標を割り当てる作業として位置づける。
- 応用（Part II）は分野別に増えるが、各ページは同一テンプレ（Problem / Functional / Geometry / Discretization / Algorithm）で記述する。
  これにより比較と実装移植が容易になる。

## 0.7 読み終えたときにできること

- 多様体／関数空間でも「勾配」「Newton」「制約（KKT）」がどう現れるかを、統一式の言葉で説明できる
- 分野別の問題を見たときに、まず Functional / Geometry ($K,J$) / Discretization / Algorithm の枠に落とせる

## 0.8 本書の構成（ロードマップ）

理論編（Part I）は、以降の応用を「同じ地図で読む」ための最小セットである。

| 章 | 主な責務 | 主に触る knob |
|----|----------|---------------|
| 第1章 | 設計自由度（4箱）の定義 | 全体フレーム |
| 第2章 | 停留構造（一次・二次変分）の定義（定義の唯一の置き場） | Space, Geometry |
| 第3章 | 統一方程式 $\dot x = (-K+J)d\mathcal F$ | Geometry, Algorithm |
| 第4章 | 停留点近傍の線形化と局所挙動 | Algorithm, Geometry |
| 第5-8章 | 手法マップ、制約、分野横断、実装 | 各章で明示 |

各章の詳細な役割は[トップページのロードマップ](../index#ロードマップ-理論編)を参照されたい。

## 0.9 読者別の最短経路

- 最適化（数値最適化）中心: 第2章→第3章→第4章→第5章→第6章（停留点・線形化・KKT を最短で接続）
- 物理（作用・Hamilton）中心: 第2章→第3章→第4章（$J$ による保存成分と停留点近傍の挙動）
- 制御（最適制御・PDE 制約）中心: 第2章→第3章→第6章→第7章（ラグランジアンとサドル点）
- 確率（VI・情報幾何）中心: 第2章→第3章→第7章→（[確率](../applications/probability/)）
- FEM / PDE 中心: 第2章→第3章→第8章→（[FEM](../applications/fem/)）

## 0.10 応用編（Part II）の使い方：テンプレ運用

応用ページは原則として同一テンプレで書く（比較と移植のため）：

- Problem
- Functional
- Geometry ($K, J$)
- Discretization
- Algorithm
- Notes

応用で分野固有に見える部分（境界条件、離散化、線形代数）は最後まで残る。
しかし「何を停留させるか（$\mathcal F$）」「どの構造で動かすか（$K,J$）」「何を計算するか（一次・二次変分）」を先に固定すると、差異は整理され、実装の再利用単位が見える。

## 0.11 参照先（最小）

- 用語: [Glossary](../glossary)
- 記法・文体: [Style Guide](../style)
