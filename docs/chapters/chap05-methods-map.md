---
title: "第5章　手法マップ"
---

> **この章で主に触るknob**: Algorithm（流れ/反復/ソルバ選択）＋ Discretization（時間離散化・反復法の見方）

## 5.0 この章の目的（見取り図）

第4章で見た通り、本書の中心は **停留条件**

$$
d\mathcal F(x)=0
$$

をどう扱うかである（有限次元ユークリッド座標では $\nabla\mathcal F(x)=0$）。
実際の数値法は「流れ（連続時間）」と「反復（離散時間）」が混ざって見えるので、
この章では方法を次の 3 軸で整理する：

- **流れの型**：散逸（降下）／保存（回転）／混合（減衰振動）
- **幾何の選択**：どの $K,J$（あるいは計量 $G$）で動かすか（第3章）
- **離散化・解法**：時間離散化か、停留条件の方程式解法か

読み進める際の参照先は次の通り：記法と統一式は [第3章](./chap03-general-equation)、線形化は [第4章](./chap04-stationary-points)、実装は [第8章](./chap08-implementation)。

## 5.1 勾配流・Hamilton・混合の位置づけ（連続時間）

### Definition (flow types)

第3章の一般形

$$
\dot x
=
-K(x)\,d\mathcal F(x)
 + J(x)\,d\mathcal F(x)
$$

において、以下の 3 類型を区別する：

| 類型 | 数式 | キーワード |
| --- | --- | --- |
| 勾配流（散逸） | $\dot x = -K\,d\mathcal F$ | 収束を作る |
| Hamilton（保存） | $\dot x = J\,d\mathcal F$ | 回転・周期 |
| 混合 | $\dot x = -K\,d\mathcal F + J\,d\mathcal F$ | 減衰振動 |

「最適化（極小化）」は停留点のうち **安定なもの（極小点）**を狙う立場だが、本書では広義に
「停留構造を数値的に扱う」ことを含めて扱う（保存系・サドル点も射程に入る）。
混合（減衰振動）の最小例は [第4章](./chap04-stationary-points) の 2D damped rotation。

## 5.2 「流れ」から「アルゴリズム」へ：離散化という視点

### Proposition (time discretization)

流れ

$$
\dot x = v(x)
$$

は時間刻み $h>0$ で離散化できる。代表例は：

- **陽的 Euler**：

$$
x_{k+1}=x_k + h\,v(x_k)
$$

- **陰的 Euler**：

$$
x_{k+1}=x_k + h\,v(x_{k+1})
$$

同じ $v(x)$ でも離散化で安定性・保存性が変わる。硬い（stiff）問題や正則化・制約を含む場合、
陰的（あるいは分割）離散化が効くことが多い。

（用語の補足）**stiff** は「時間刻みを大きくすると数値的に不安定になりやすい」性質を指す（陰的法が効きやすい）。

## 5.3 Newton 法の二面性：Algorithm か Geometry か

Newton 法（およびその変種）は、本書の 4 つの knobs において二通りの解釈ができる。この二面性を理解することで、前処理や準 Newton 法の位置づけが明確になる。

### 1. Algorithm としての Newton（方程式ソルバ）
*   **視点**: 停留条件という非線形方程式 $d\mathcal F(x) = 0$ を直接解く。
*   **操作**: $x_{k+1} = x_k - H(x_k)^{-1} d\mathcal F(x_k)$
*   **特徴**: 二次収束が期待できるが、Hessian $H$ の逆作用（ソルバ）が必要。

### 2. Geometry としての Newton（Hessian 計量による勾配流）
*   **視点**: 計量 $G$ として Hessian $H$ 自体を採用した「勾配流」とみなす。
*   **操作**: $\dot x = -K d\mathcal F$ において $K = H^{-1}$ と選択する。
*   **特徴**: 空間の曲がり（Hessian）に合わせて歩幅を調整する「自然勾配」の究極形。これは空間の曲率 $H$ を平らにするような座標変換（前処理）を行ってから、まっすぐ降りる操作と等価である。

| 解釈 | 注目する knob | 実装上の関心 |
| --- | --- | --- |
| **Algorithm** | **Algorithm** | 非線形方程式を何反復で解くか、減衰 (damping) をどう入れるか |
| **Geometry** | **Geometry** | どの計量（前処理）で空間の歪みを補正するか |

この視点は、**準 Newton 法（BFGS 等）** を「Hessian を Algorithm として逐次更新している」と見るか、「計量 $G$ を Geometry として学習している」と見るかの違いにも通じる。

## 5.4 代表的手法の対応表（最小マップ）

| 目的 | 連続時間の見方 | 代表的な離散アルゴリズム（例） |
| --- | --- | --- |
| 降下（散逸） | $\dot x=-K\,d\mathcal F$ | 最急降下（$K=I$）、自然勾配（$K=G_{\text{Fisher}}^{-1}$）、前処理付き勾配、鏡映降下（Mirror Descent） |
| 停留点（方程式） | $d\mathcal F=0$ を解く | Newton、準 Newton（BFGS/L-BFGS）、Gauss–Newton（最小二乗）、非線形 CG |
| 保存（回転） | $\dot x=J\,d\mathcal F$ | シンプレクティック積分（例：Stormer–Verlet） |
| 混合（減衰振動） | $\dot x=-K\,d\mathcal F+J\,d\mathcal F$ | 分割法（splitting）、減衰付き Hamilton（運動量法の連続極限としての見方） |

ここで「幾何」の役割は次の通り：$G$ は距離（内積）を決め、$K = G^{-1}$ が **どの方向を 1 とみなすか**（前処理・自然勾配）に対応する。
$J$ は回転（保存）を作り、**等高線に沿う成分**を足す役割を持つ。

## 5.5（最小）選び方：いつ何を使うか

- **大規模で Hessian が無理**：勾配流系（最急降下、前処理、L-BFGS など）から始める
- **局所二次近似が効く・中規模**：Newton/準 Newton が有利
- **正則化・分離構造が強い**：陰的離散化や近接（prox）に寄せると安定しやすい
- **保存量が重要（物理・力学）**：Hamilton 系＋シンプレクティック離散化
- **制約が本質**：KKT（第6章）として「サドル点を解く」発想に切り替える

## 5.6 制約付き：KKT はサドル点の“地形”

制約を入れると停留点は一般にサドルになり、
「極小化」と同様の直観だけでは扱えない。
一方で第6章のように **ラグランジアン $\mathcal L$ の停留構造**として統一できる。

制約付きでは「目的関数を下げる」よりも、**停留条件（KKT）を満たす点を探す**方が自然になる。
この意味で第6章は、この章の方法マップを制約へ拡張した位置づけである。

